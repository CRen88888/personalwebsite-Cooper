<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Analytics Dashboard | Cooper Ren</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="js/theme-analytics.js" defer></script>
    <style>
      nav {
        position: fixed;
        top: 0;
        width: 100%;
        background: rgba(0, 0, 0, 0.85);
        backdrop-filter: blur(15px);
        box-shadow: 0 2px 20px rgba(255, 0, 110, 0.2);
        border-bottom: 1px solid rgba(255, 0, 110, 0.3);
        z-index: 1000;
        padding: 1rem 0;
      }

      body.theme-light nav {
        background: rgba(255, 255, 255, 0.95);
        border-bottom: 1px solid rgba(255, 0, 110, 0.2);
        box-shadow: 0 2px 20px rgba(0, 0, 0, 0.1);
      }

      .nav-container {
        max-width: 1400px;
        margin: 0 auto;
        padding: 0 2rem;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .logo {
        font-size: 1.5rem;
        font-weight: 700;
        background: linear-gradient(135deg, #ff006e, #fb5607, #ff006e);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        text-decoration: none;
      }

      .nav-links {
        display: flex;
        gap: 2rem;
        list-style: none;
      }

      .nav-links a {
        text-decoration: none;
        color: #ffffff;
        font-weight: 500;
        transition: color 0.3s ease;
        position: relative;
      }

      body.theme-light .nav-links a {
        color: #000000;
      }

      .nav-links a:hover {
        color: #ff006e;
      }

      .nav-links a.active {
        color: #ff006e;
      }

      .nav-links a.active::after {
        content: '';
        position: absolute;
        bottom: -5px;
        left: 0;
        width: 100%;
        height: 2px;
        background: linear-gradient(135deg, #ff006e, #fb5607);
      }

      .theme-toggle-btn {
        background: rgba(255, 0, 110, 0.2);
        border: 1px solid rgba(255, 0, 110, 0.3);
        border-radius: 50%;
        width: 40px;
        height: 40px;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        font-size: 1.2rem;
        transition: all 0.3s ease;
        margin-left: 1rem;
      }

      .theme-toggle-btn:hover {
        background: rgba(255, 0, 110, 0.4);
        transform: scale(1.1);
      }

      body.theme-light .theme-toggle-btn {
        background: rgba(255, 0, 110, 0.1);
        border-color: rgba(255, 0, 110, 0.2);
      }

      body.theme-light .theme-toggle-btn:hover {
        background: rgba(255, 0, 110, 0.2);
      }

      .container {
        padding-top: 6rem;
      }
    </style>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: 'Inter', sans-serif;
        background: linear-gradient(135deg, #000000 0%, #1a0000 25%, #2d0000 50%, #1a001a 75%, #000000 100%);
        color: #ffffff;
        padding: 2rem;
        min-height: 100vh;
        transition: background 0.3s ease;
      }

      body.theme-light {
        background: linear-gradient(135deg, #ffffff 0%, #f5f5f5 25%, #e8e8e8 50%, #f0f0f0 75%, #ffffff 100%);
        color: #000000;
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
      }

      h1 {
        margin-bottom: 2rem;
        background: linear-gradient(135deg, #ff006e, #fb5607);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
      }

      .section {
        background: rgba(26, 26, 26, 0.8);
        border: 1px solid rgba(255, 0, 110, 0.2);
        border-radius: 15px;
        padding: 2rem;
        margin-bottom: 2rem;
      }

      body.theme-light .section {
        background: rgba(255, 255, 255, 0.9);
        border-color: rgba(255, 0, 110, 0.3);
      }

      .section h2 {
        color: #ff006e;
        margin-bottom: 1rem;
      }

      .data-item {
        margin: 0.5rem 0;
        padding: 0.5rem;
        background: rgba(0, 0, 0, 0.3);
        border-radius: 8px;
      }

      body.theme-light .data-item {
        background: rgba(0, 0, 0, 0.05);
      }

      .data-label {
        font-weight: 600;
        color: #ff006e;
      }

      pre {
        background: rgba(0, 0, 0, 0.5);
        padding: 1rem;
        border-radius: 8px;
        overflow-x: auto;
        font-size: 0.9rem;
      }

      body.theme-light pre {
        background: rgba(0, 0, 0, 0.05);
        color: #000000;
      }

      .btn {
        padding: 0.75rem 1.5rem;
        background: linear-gradient(135deg, #ff006e, #fb5607);
        color: white;
        border: none;
        border-radius: 25px;
        cursor: pointer;
        margin: 0.5rem 0.5rem 0.5rem 0;
        font-weight: 600;
      }

      .btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 15px rgba(255, 0, 110, 0.4);
      }
    </style>
  </head>
  <body>
    <nav>
      <div class="nav-container">
        <a href="index.html" class="logo">Cooper Ren</a>
        <ul class="nav-links">
          <li><a href="index.html">Home</a></li>
          <li><a href="about.html">About</a></li>
          <li><a href="projects.html">Projects</a></li>
          <li><a href="educational.html">Pascal's Triangle</a></li>
          <li><a href="pokemoncards.html">Pokémon Cards</a></li>
          <li><a href="analytics.html" class="active">Analytics</a></li>
          <li><a href="snake.html">Snake Game</a></li>
          <li><a href="index.html#contact">Contact</a></li>
        </ul>
      </div>
    </nav>
    <div class="container">
      <h1>Analytics Dashboard (Educational Purposes)</h1>
      
      <div class="section">
        <h2>User Information</h2>
        <div id="userInfo"></div>
      </div>

      <div class="section">
        <h2>Device & Browser Information</h2>
        <div id="deviceInfo"></div>
      </div>

      <div class="section">
        <h2>Session Statistics</h2>
        <div id="sessionStats"></div>
      </div>

      <div class="section">
        <h2>Theme Changes</h2>
        <div id="themeChanges"></div>
      </div>

      <div class="section">
        <h2>Recent Interactions</h2>
        <div id="interactions"></div>
      </div>

      <div class="section">
        <h2>Data Management</h2>
        <button class="btn" onclick="exportData()">Export as JSON</button>
        <button class="btn" onclick="clearData()">Clear All Data</button>
      </div>
    </div>

    <script>
      function displayAnalytics() {
        // Get data from cookies
        const cookieData = window.AnalyticsTracker?.getAnalyticsData() || { data: null, interactions: [], themeChanges: [] };
        
        // Get current session data from AnalyticsTracker
        const currentData = window.AnalyticsTracker?.AnalyticsData || {};
        
        // Use current session data if cookie data is empty
        const analytics = {
          data: cookieData.data || {
            userId: currentData.userId || 'Not set',
            sessionId: currentData.sessionId || 'Not set',
            timezone: currentData.timezone || Intl.DateTimeFormat().resolvedOptions().timeZone,
            language: currentData.language || navigator.language,
            lastUpdate: Date.now(),
            deviceInfo: currentData.deviceInfo || window.AnalyticsTracker?.getDeviceInfo(),
            browserInfo: currentData.browserInfo || window.AnalyticsTracker?.getBrowserInfo(),
            screenInfo: currentData.screenInfo || window.AnalyticsTracker?.getScreenInfo(),
            pageViewCount: currentData.pageViews?.length || 0,
            interactionCount: currentData.interactions?.length || 0,
            themeChangeCount: currentData.themeChanges?.length || 0
          },
          interactions: cookieData.interactions || currentData.interactions || [],
          themeChanges: cookieData.themeChanges || currentData.themeChanges || []
        };
        
        // User Info
        if (analytics.data) {
          document.getElementById('userInfo').innerHTML = `
            <div class="data-item"><span class="data-label">User ID:</span> ${analytics.data.userId}</div>
            <div class="data-item"><span class="data-label">Session ID:</span> ${analytics.data.sessionId}</div>
            <div class="data-item"><span class="data-label">Timezone:</span> ${analytics.data.timezone}</div>
            <div class="data-item"><span class="data-label">Language:</span> ${analytics.data.language}</div>
            <div class="data-item"><span class="data-label">Last Update:</span> ${analytics.data.lastUpdate ? new Date(analytics.data.lastUpdate).toLocaleString() : 'Just now'}</div>
          `;
        } else {
          document.getElementById('userInfo').innerHTML = '<div class="data-item">No user data available yet. Interact with the site to generate data.</div>';
        }

        // Device Info
        if (analytics.data?.deviceInfo) {
          const device = analytics.data.deviceInfo;
          const browser = analytics.data.browserInfo || {};
          const screen = analytics.data.screenInfo || {};
          
          document.getElementById('deviceInfo').innerHTML = `
            <div class="data-item"><span class="data-label">Platform:</span> ${device.platform || 'Unknown'}</div>
            <div class="data-item"><span class="data-label">Browser:</span> ${browser.browser || 'Unknown'} ${browser.version || ''}</div>
            <div class="data-item"><span class="data-label">Screen:</span> ${screen.width || 'Unknown'}x${screen.height || 'Unknown'}</div>
            <div class="data-item"><span class="data-label">Viewport:</span> ${screen.innerWidth || window.innerWidth}x${screen.innerHeight || window.innerHeight}</div>
            <div class="data-item"><span class="data-label">Device Pixel Ratio:</span> ${screen.devicePixelRatio || window.devicePixelRatio || 1}</div>
            <div class="data-item"><span class="data-label">Hardware Concurrency:</span> ${device.hardwareConcurrency || navigator.hardwareConcurrency || 'Unknown'}</div>
            <div class="data-item"><span class="data-label">Online:</span> ${device.onLine !== undefined ? (device.onLine ? 'Yes' : 'No') : (navigator.onLine ? 'Yes' : 'No')}</div>
            <div class="data-item"><span class="data-label">Cookie Enabled:</span> ${device.cookieEnabled !== undefined ? (device.cookieEnabled ? 'Yes' : 'No') : (navigator.cookieEnabled ? 'Yes' : 'No')}</div>
          `;
        } else {
          // Fallback to current browser info
          const deviceInfo = window.AnalyticsTracker?.getDeviceInfo();
          const browserInfo = window.AnalyticsTracker?.getBrowserInfo();
          const screenInfo = window.AnalyticsTracker?.getScreenInfo();
          
          document.getElementById('deviceInfo').innerHTML = `
            <div class="data-item"><span class="data-label">Platform:</span> ${deviceInfo?.platform || navigator.platform}</div>
            <div class="data-item"><span class="data-label">Browser:</span> ${browserInfo?.browser || 'Unknown'} ${browserInfo?.version || ''}</div>
            <div class="data-item"><span class="data-label">Screen:</span> ${screenInfo?.width || screen.width}x${screenInfo?.height || screen.height}</div>
            <div class="data-item"><span class="data-label">Viewport:</span> ${screenInfo?.innerWidth || window.innerWidth}x${screenInfo?.innerHeight || window.innerHeight}</div>
            <div class="data-item"><span class="data-label">Device Pixel Ratio:</span> ${screenInfo?.devicePixelRatio || window.devicePixelRatio || 1}</div>
            <div class="data-item"><span class="data-label">Hardware Concurrency:</span> ${deviceInfo?.hardwareConcurrency || navigator.hardwareConcurrency || 'Unknown'}</div>
            <div class="data-item"><span class="data-label">Online:</span> ${deviceInfo?.onLine !== undefined ? (deviceInfo.onLine ? 'Yes' : 'No') : (navigator.onLine ? 'Yes' : 'No')}</div>
          `;
        }

        // Session Stats
        if (analytics.data) {
          document.getElementById('sessionStats').innerHTML = `
            <div class="data-item"><span class="data-label">Page Views:</span> ${analytics.data.pageViewCount || 0}</div>
            <div class="data-item"><span class="data-label">Total Interactions:</span> ${analytics.data.interactionCount || 0}</div>
            <div class="data-item"><span class="data-label">Theme Changes:</span> ${analytics.data.themeChangeCount || 0}</div>
            <div class="data-item"><span class="data-label">Current Page:</span> ${currentData.currentPage || window.location.pathname}</div>
            <div class="data-item"><span class="data-label">Referrer:</span> ${currentData.referrer || document.referrer || 'Direct'}</div>
          `;
        }

        // Theme Changes
        const allThemeChanges = analytics.themeChanges || currentData.themeChanges || [];
        if (allThemeChanges.length > 0) {
          const themeList = allThemeChanges.slice(-10).reverse().map(tc => 
            `<div class="data-item">${new Date(tc.timestamp).toLocaleString()}: ${tc.from} → ${tc.to} (${tc.page || 'unknown'})</div>`
          ).join('');
          document.getElementById('themeChanges').innerHTML = themeList;
        } else {
          const currentTheme = document.body.classList.contains('theme-light') ? 'light' : 'dark';
          document.getElementById('themeChanges').innerHTML = `<div class="data-item">No theme changes recorded. Current theme: ${currentTheme}</div>`;
        }

        // Interactions
        const allInteractions = analytics.interactions || currentData.interactions || [];
        if (allInteractions.length > 0) {
          const interactionList = allInteractions.slice(-20).reverse().map(inter => 
            `<div class="data-item">${new Date(inter.timestamp).toLocaleString()}: ${inter.type} on ${inter.element || 'unknown'}${inter.elementId && inter.elementId !== 'none' ? ' (' + inter.elementId + ')' : ''}</div>`
          ).join('');
          document.getElementById('interactions').innerHTML = interactionList;
        } else {
          document.getElementById('interactions').innerHTML = '<div class="data-item">No interactions recorded yet. Start clicking around the site to generate data!</div>';
        }
      }

      function exportData() {
        const analytics = window.AnalyticsTracker?.getAnalyticsData() || {};
        const dataStr = JSON.stringify(analytics, null, 2);
        const dataBlob = new Blob([dataStr], { type: 'application/json' });
        const url = URL.createObjectURL(dataBlob);
        const link = document.createElement('a');
        link.href = url;
        link.download = `analytics-${Date.now()}.json`;
        link.click();
        URL.revokeObjectURL(url);
      }

      function clearData() {
        if (confirm('Are you sure you want to clear all analytics data? This cannot be undone.')) {
          document.cookie.split(";").forEach(c => {
            if (c.trim().startsWith('analytics_') || c.trim().startsWith('theme_')) {
              document.cookie = c.replace(/^ +/, "").replace(/=.*/, "=;expires=" + new Date().toUTCString() + ";path=/");
            }
          });
          location.reload();
        }
      }

      // Update display every 5 seconds
      setInterval(displayAnalytics, 5000);
      displayAnalytics();
    </script>
  </body>
</html>

